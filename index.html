<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fishing Tides Test</title>
  <style>
    body { font-family:sans-serif; background:#eafaf7; color:#18558e; padding:16px;}
    .fish-tide { font-size: 1.1em; margin: 20px 0;}
    .fish-swell img { width:100%; max-width:350px;}
  </style>
</head>
<body>
  <h2>Thames Coast Fishing & Swell</h2>
  <div id="tides">Loading tides…</div>
  <div class="fish-swell">
    <a href="https://www.swellmap.com/surf/forecast/thames" target="_blank">
      <img src="https://www.swellmap.com/static/surf/forecasts/thames/thames-surf-forecast-large.png" alt="Thames Swell Map"/>
      <div>Tap for full Swellmap Thames</div>
    </a>
  </div>
  <script>
    // TIDESPY API
    fetch('https://api.tidespy.com/v1/times?loc=thames&days=1', {
      headers: { "x-api-key": "5m6BgsUMZbwYherOSkoFVz7I2cnKA3R8" }
    })
      .then(r => r.json())
      .then(data => {
        if (data.tides && Array.isArray(data.tides)) {
          let out = '<b>Tides (Thames):</b><ul>';
          data.tides.forEach(t => {
            const time = new Date(t.time).toLocaleTimeString("en-NZ", { hour: '2-digit', minute: '2-digit' });
            out += `<li>${t.type}: <b>${time}</b> (${t.height.toFixed(1)} m)</li>`;
          });
          out += '</ul>';
          document.getElementById('tides').innerHTML = out;
        } else {
          document.getElementById('tides').innerHTML = "No tide data returned.";
        }
      })
      .catch(e => {
        document.getElementById('tides').innerHTML = "Couldn’t load tides (check API key).";
      });
  </script>
</body>
</html>